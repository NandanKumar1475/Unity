using UnityEngine;
using UnityEngine.InputSystem;

public class MathfLerp : MonoBehaviour
{
    [Header("Movement Settings")]
    public float duration = 1.5f;    // time to reach target
    private float elapsed = 0f;
    private bool hasTarget = false;

    private Vector3 startPos;
    private Vector3 targetPos;

    void Update()
    {
        MoveGameObjectWhenClickMouse();
    }

    public void MoveGameObjectWhenClickMouse()
    {
        // check for click
        if (Mouse.current.leftButton.wasPressedThisFrame)
        {
            // Ray from camera to mouse
            Ray ray = Camera.main.ScreenPointToRay(Mouse.current.position.ReadValue());
            if (Physics.Raycast(ray, out RaycastHit hit, 500f))
            {
                // set target where ray hits (ground or object)
                targetPos = hit.point;
                startPos = transform.position;
                hasTarget = true;
                elapsed = 0f;

                Debug.Log("Clicked point: " + targetPos);
            }
        }

        // Move smoothly toward target if we have one
        if (hasTarget)
        {
            elapsed += Time.deltaTime;
            float t = Mathf.Clamp01(elapsed / duration);

            transform.position = Vector3.Lerp(startPos, targetPos, t);

            // Stop when reached target
            if (t >= 1f)
            {
                hasTarget = false;
            }
        }
    }

    // Optional: direct follow mouse position (for 2D use)
    public void MoveTheGameobjectWithMousePosition()
    {
        elapsed += Time.deltaTime;
        float t = Mathf.Clamp01(elapsed / duration);

        Vector2 screenPos = Mouse.current.position.ReadValue();
        Vector3 targetpos = new Vector3(screenPos.x, screenPos.y, 10f);
        Vector3 worldPos = Camera.main.ScreenToWorldPoint(targetpos);

        transform.position = Vector3.Lerp(transform.position, worldPos, t);
    }
}
